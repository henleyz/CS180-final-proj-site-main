<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1170X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1170"/>
  <meta property="og:image:height" content="630"/>




  <title>CS180 Proj5</title>
  <link rel="icon" type="image/jpg" href="static/images/5a/iic3.png">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Neural Radiance Fields</h1>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Henley Zhang<br>December 11, 1724</span>
                  </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Intro</h2><img src="static/images/5a/rocket.png" alt="emir" class="abstract-image" style="width: 170%;">
        <div class="content has-text-justified">
          
          <p>
           This project shows how to use Neural Radiance Fields to create images or video from novel viewing angles. 
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Paper abstract -->
<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">1. Fit a Neural Field to a 2d image</h2>
        <h3 class="title is-4">Approach</h3>

        <div class="content has-text-justified">
          <p>
              For this part, we created a Sinusoidal Positional Encoding layuer that converts a tensor of coordinates into a tensor of Positional Encodings. 
The main structure is a multi layer perceptron with 3 layers. 
            </p>





          <img src="static/images/fox_0.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_1.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_2.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_3.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_4.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_5.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_6.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_7.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_8.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_9.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_10.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_11.png" alt="fox" class="abstract-image">
          <img src="static/images/fox_12.png" alt="fox" class="abstract-image">

          <img src="static/images/fox_13.png" alt="fox" class="abstract-image">


          <h3 class="title is-4">Results</h3>

          <img src="static/images/fox_13.png" alt="fox" class="abstract-image">
          <h3 class="title is-5">Predicted Fox</h3>

          <img src="static/images/fox.jpg" alt="fox" class="abstract-image">

          <h3 class="title is-5">Original Fox</h3>

          <img src="static/images/psnrfox.png" alt="fox" class="abstract-image">
          <h3 class="title is-5">Iterations vs PSNR graph for Fox</h3>

          <img src="static/images/msefox.png" alt="fox" class="abstract-image">





          <h3 class="title is-5">Iterations vs MSE graph for Fox</h3>


          <h3 class="title is-4">Example for Oski</h3>

          <img src="static/images/oski0.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski1.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski2.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski3.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski4.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski5.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski6.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski7.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski8.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski9.jpg" alt="oski" class="abstract-image">
          <img src="static/images/oski.jpg" alt="oski" class="abstract-image">

          <h3 class="title is-5">Original Oski</h3>

          <img src="static/images/oskipsnr.png" alt="oski" class="abstract-image">

          <h3 class="title is-5">Iterations vs PSNR graph for Oski</h3>

          <img src="static/images/oskimse.png" alt="oski" class="abstract-image">

          <h3 class="title is-5">Iterations vs MSE graph for Oski</h3>





          <h3 class="title is-4">HyperParameter Training</h3>
          <p>I tried to find the  best combination of learning rate and number of layers. It trurns out 7 layers with a small learning rate of 0.001 yielded the best results. </p>

          <img src="static/images/psnr_lines.png" alt="hyper" class="abstract-image" style="width: 100%;">

          <h3 class="title is-5">PSNR vs Iterations for different learning rates and layers</h3>

          <img src="static/images/msetrails.png" alt="hyper" class="abstract-image" style="width: 100%;">

          <h3 class="title is-5">MSE vs Iterations for different learning rates and layers</h3>

          <img src="static/images/foxse.png" alt="hyper" class="abstract-image" style="width: 100%;">






          



          
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <h2  class="title is-3">2.1 Create Rays from Cameras</h2>
        <h3 class="title is-4">Camera to World Coordinate Conversion</h3>
        <div class="content has-text-justified">
          <p>This is the transform functionm, which simply converts 3D points from camera coordinates to world coordinates. takes a transformation matrix (c2w) and a batch of 3D points (x_c), extends the points into homogeneous coordinates, applies the transformation, and then converts the result back into standard 3D coordinates by dividing by the homogeneous scale factor.</p>
          
          <h3 class="title is-4">Pixel to Camera Conversion</h3>
  
            <p>This is the pixel_to_camera function, whcih transforms 2D pixel coordinates (uv) from the image plane into 3D camera coordinates. Using the camera  matrix (K) and a scaling factor (s), it first converts the pixel coordinates into homogeneous form, applies the inverse of the intrinsic matrix to map them to normalized camera coordinates, and then scales the result to return the 3D camera coordinates.

              <h3 class="title is-4">Pixel to Ray</h3>
  
              <p> This is the pixel_to_ray function, which computes the origin (r_o) and direction (r_d) of 3D rays in world coordinates, given pixel coordinates (uv), the camera intrinsic matrix (K), and the camera-to-world transformation matrix (c2w).
                
                It first determines the camera origin in world coordinates by inverting the camera's rotation and translation. Then, it converts the pixel coordinates into normalized camera coordinates using pixel_to_camera and transforms them to world coordinates using transform. Finally, it calculates the ray direction from the camera origin to the transformed world coordinates and normalizes it. The resulting rays (r_o, r_d) describe the path of light through the camera into the scene.
  
  

                <h2  class="title is-3">2.2 Sampling</h2>



          <h3 class="title is-4">Sampling Rays from Image</h3>
  
            <p>This is the  sample_rays_from_images function, which samples pixel values and computes 3D rays for a batch of images. It converts pixel coordinates to rays using the pixel_to_ray function and gathers the pixel values, ray origins, and directions for all images into concatenated tensors.
            
          
              <h3 class="title is-4">Sampling Points along the Rays</h3>
              <p> This is thee sample_points_along_rays function, which samples points along each ray by generating num_samples points between a specified near and far distance. It perturbs the sampling positions if perturb is enabled, then calculates the 3D coordinates of the sampled points along the ray by using the ray origins (rays_o) and directions (rays_d).</p>


   
        </div>








    </div>


      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<!-- Paper abstract -->
<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">2.3 Putting the Dataloading all together</h2>
        <h3 class="title is-4">NerfDataset Class. </h3>

        <div class="content has-text-justified">
          <p> 
           This class converts an image into a PyTorch dataset where each pixel is treated as a data sample. For a given index, it returns the normalized 2D coordinates of the pixel and its color values as tensors.
          </p>



            <h3 class="title is-4">With the given Visualzation code, it produced these images with pertrub = True. </h3>
            <div class="image-caption-set">
              <img src="static/images/visio.png" alt="church" class="abstract-image" style="width: max-content;">
              <h3 class="title is-5">Sample 1</h3>
            </div>


            
      

        </div>





        <h2 class="title is-3">2.4 Neural Radiance Field</h2>
        <h3 class="title is-4">Approach</h3>

        <div class="content has-text-justified">
          <p> 
           I created this neural network composed for several smaller subnets. I reused the positoinal encoding network from the first part. For the forward pass, we call sample along the rays, which as passed into the model, which is then reshaped and passed into the volrend function. To render the image, the x and y pixels are combined into a tensor and passed into pixel to ray, which is then passed into the model and volrend to create the image. 
          </p>
          <img src="static/images/mlp_nerf.png" alt="forward" style="width: max-content" >

                
          <h3 class="title is-4">2.5 Volume Rendering</h3>
          <p> This is volrend function, which takes in B x N x 1 sigmas and B x N x 3 colors tensors and well as sampled deltas. It calculates the cumulative absorption (cumulative_sigmas) and the probabilities of light not terminating (prob_not_terminate) or terminating (prob_terminate) at each point.  Probabilities are used to weight the RGB colors, and the function then returns the accumulated color values] after rendering the scene.



            <h3 class="title is-4">Validation Images</h3>

   
              <img src="static/images/image_0_0.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_1.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_2.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_3.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_4.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_5.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_6.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_7.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_8.png"  class="abstract-image" style="width: 17%;">
              <img src="static/images/image_0_9.png"  class="abstract-image" style="width: 17%;">
              <br>

              <img src="static/images/image_5_0.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_1.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_2.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_3.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_4.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_5.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_6.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_7.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_8.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_5_9.png" class="abstract-image" style="width: 17%;">
<br>

<img src="static/images/image_10_0.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_1.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_2.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_3.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_4.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_5.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_6.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_7.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_8.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_10_9.png" class="abstract-image" style="width: 17%;">
<br>

<img src="static/images/image_15_0.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_1.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_2.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_3.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_4.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_5.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_6.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_7.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_8.png" class="abstract-image" style="width: 17%;">
<img src="static/images/image_15_9.png" class="abstract-image" style="width: 17%;">



<img src="static/images/gif.gif"  class="abstract-image" style="width: 100%">


<img src="static/images/psnr.png"  class="abstract-image" style="width: 100%">
<h3 class="title is-5">PSNR vs Iterations</h3>

<img src="static/images/mse.png"  class="abstract-image" style="width: 100%">

<h3 class="title is-5">Bells and Whistles - Color Background</h3>
<p>


  In the volrend_colorbg function, I added the background color  by first calculating the total opacity along each ray (bg_prod) as the sum of the products of sigmas and step_size. The background weight (bg_weights) is then computed as the exponential of the negative bg_prod, determining how much of the background color should be visible. The background color, defined as a light blue ([0.5, 0.7, 1.0]), is weighted by bg_weights, and this contribution is added to the cumulative colors obtained from the volumetric rendering. This results in the final color that incorporates both the volumetric effects and the background. It looks awful because some of the floor appears as opaque. 



</p>


<img src="static/images/colorbackground.gif"  class="abstract-image" style="width: 100%">


        </div>
      </div>
    </div>
  </div>
</section>
 







<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
